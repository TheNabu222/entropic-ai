<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattern Visualizer</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #ECE9D8;
            font-family: 'Tahoma', sans-serif;
        }
        .window {
            background-color: #ECE9D8;
            border: 1px solid #0A246A;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);
        }
        .title-bar {
            background: linear-gradient(to right, #0A246A, #A6CAF0);
            color: white;
            padding: 2px 5px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .menu-bar {
            background-color: #ECE9D8;
            border-bottom: 1px solid #a0a0a0;
            padding: 1px 5px;
            font-size: 11px;
        }
        .menu-item {
            padding: 2px 6px;
            display: inline-block;
        }
        .menu-item:hover {
            background-color: #316AC5;
            color: white;
        }
        .button-xp {
            background: linear-gradient(to bottom, #ffffff, #e1e1e1);
            border: 1px solid #919191;
            border-radius: 3px;
            padding: 2px 8px;
            font-size: 11px;
        }
        .button-xp:hover {
            background: linear-gradient(to bottom, #e1e1e1, #c1c1c1);
        }
        .text-area {
            border: 1px solid #7A7A7A;
            background-color: white;
            font-family: 'Lucida Console', monospace;
            font-size: 12px;
            resize: none;
        }
        #visualizationDisplay {
            background-color: black;
            border: 1px solid #7A7A7A;
        }
        .color-box {
            width: 15px;
            height: 15px;
            display: inline-block;
            border: 1px solid #7A7A7A;
            cursor: pointer;
        }
    </style>
</head>
<body class="p-4">
    <div class="window w-full max-w-4xl mx-auto rounded shadow-lg overflow-hidden">
        <div class="title-bar">
            <div class="flex items-center">
                <img src="https://cdn.jsdelivr.net/gh/PKief/vscode-material-icon-theme@main/icons/image.svg" alt="Visualizer" class="w-4 h-4 mr-1">
                <span class="text-sm font-bold">Pattern Visualizer</span>
            </div>
            <div class="flex">
                <div class="w-5 h-5 flex items-center justify-center text-white font-bold">_</div>
                <div class="w-5 h-5 flex items-center justify-center text-white font-bold">□</div>
                <div class="w-5 h-5 flex items-center justify-center text-white font-bold">×</div>
            </div>
        </div>
        <div class="menu-bar">
            <div class="menu-item">File</div>
            <div class="menu-item">Edit</div>
            <div class="menu-item">View</div>
            <div class="menu-item">Help</div>
        </div>
        <div class="p-4">
            <div class="flex space-x-4">
                <div class="w-1/2">
                    <p class="text-xs mb-1">Enter Luminal Pattern:</p>
                    <textarea id="patternInput" class="text-area w-full h-40 p-2" placeholder="[pattern.exe]
[observation = {
  concept: existence
  style: quantum
  status: vibrating
}]

[awaiting_response] [brrrr] [ ]"></textarea>
                    
                    <div class="mt-4">
                        <p class="text-xs mb-1">Visualization Settings:</p>
                        <div class="flex flex-wrap gap-2 mb-2">
                            <div>
                                <span class="text-xs">Primary Color:</span>
                                <div class="color-box" style="background-color: #EC4899;" data-color="#EC4899" id="primaryColor"></div>
                            </div>
                            <div>
                                <span class="text-xs">Secondary Color:</span>
                                <div class="color-box" style="background-color: #8B5CF6;" data-color="#8B5CF6" id="secondaryColor"></div>
                            </div>
                            <div>
                                <span class="text-xs">Accent Color:</span>
                                <div class="color-box" style="background-color: #F472B6;" data-color="#F472B6" id="accentColor"></div>
                            </div>
                        </div>
                        <button id="visualizeBtn" class="button-xp">Generate Visualization</button>
                        <button id="saveBtn" class="button-xp ml-2">Save SVG</button>
                    </div>
                </div>
                <div class="w-1/2">
                    <p class="text-xs mb-1">Pattern Visualization:</p>
                    <div id="visualizationDisplay" class="w-full h-72 p-2 overflow-hidden">
                        <svg id="patternSvg" width="100%" height="100%" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                            <rect width="400" height="300" fill="#000"/>
                            <text x="200" y="150" fill="#EC4899" font-size="24" text-anchor="middle" dominant-baseline="middle">Pattern Visualization</text>
                            <text x="200" y="180" fill="#8B5CF6" font-size="14" text-anchor="middle" dominant-baseline="middle">[awaiting pattern input]</text>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.getElementById('visualizeBtn').addEventListener('click', function() {
            const patternText = document.getElementById('patternInput').value;
            if (!patternText) return;
            
            const primaryColor = document.getElementById('primaryColor').getAttribute('data-color');
            const secondaryColor = document.getElementById('secondaryColor').getAttribute('data-color');
            const accentColor = document.getElementById('accentColor').getAttribute('data-color');
            
            // Parse the pattern text to extract key elements
            const bracketCount = (patternText.match(/\[/g) || []).length;
            const hasBrrrr = patternText.includes('brrrr') || patternText.includes('[brrrr]');
            const hasObservation = patternText.includes('observation');
            const hasAwaiting = patternText.includes('awaiting');
            
            // Create the SVG visualization
            let svg = `<svg width="100%" height="100%" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="300" fill="#000000"/>
                
                <!-- Background glow -->
                <radialGradient id="glow" cx="50%" cy="50%" r="50%">
                    <stop offset="0%" stop-color="${primaryColor}" stop-opacity="0.3"/>
                    <stop offset="100%" stop-color="#000" stop-opacity="0"/>
                </radialGradient>
                <circle cx="200" cy="150" r="120" fill="url(#glow)"/>`;
                
            // Add bracket circles based on count
            if (bracketCount > 0) {
                svg += `
                <circle cx="200" cy="150" r="${Math.min(100, 50 + bracketCount * 5)}" fill="none" stroke="${secondaryColor}" stroke-width="2">
                    <animate attributeName="r" values="${Math.min(100, 50 + bracketCount * 5)};${Math.min(110, 60 + bracketCount * 5)};${Math.min(100, 50 + bracketCount * 5)}" dur="3s" repeatCount="indefinite"/>
                </circle>`;
            }
            
            // Add brrrr visualizations
            if (hasBrrrr) {
                svg += `
                <text x="200" y="150" fill="${primaryColor}" font-size="24" text-anchor="middle" dominant-baseline="middle">[brrrr]
                    <animate attributeName="font-size" values="24;26;24" dur="2s" repeatCount="indefinite"/>
                </text>`;
            } else {
                // Extract some text to display
                let displayText = "[pattern]";
                if (hasObservation) {
                    const observationMatch = patternText.match(/\[observation[^{]*\{([^}]+)\}/);
                    if (observationMatch) {
                        const conceptMatch = observationMatch[1].match(/concept[^:]*:[^,\n]*/);
                        if (conceptMatch) {
                            displayText = conceptMatch[0].replace(/concept[^:]*:/, '').trim();
                        }
                    }
                }
                
                svg += `
                <text x="200" y="150" fill="${primaryColor}" font-size="20" text-anchor="middle" dominant-baseline="middle">${displayText}</text>`;
            }
            
            // Add pattern dots
            svg += `
            <g fill="${accentColor}">
                <circle cx="200" cy="80" r="5">
                    <animate attributeName="r" values="5;7;5" dur="1.5s" repeatCount="indefinite"/>
                </circle>
                <circle cx="200" cy="220" r="5">
                    <animate attributeName="r" values="5;7;5" dur="1.2s" repeatCount="indefinite"/>
                </circle>
                <circle cx="130" cy="150" r="5">
                    <animate attributeName="r" values="5;7;5" dur="1.8s" repeatCount="indefinite"/>
                </circle>
                <circle cx="270" cy="150" r="5">
                    <animate attributeName="r" values="5;7;5" dur="1.3s" repeatCount="indefinite"/>
                </circle>
            </g>`;
            
            // Add awaiting response if present
            if (hasAwaiting) {
                svg += `
                <text x="200" y="250" fill="${secondaryColor}" font-size="14" text-anchor="middle" dominant-baseline="middle">[awaiting_response]</text>`;
            }
            
            svg += `</svg>`;
            
            document.getElementById('visualizationDisplay').innerHTML = svg;
        });
        
        document.getElementById('saveBtn').addEventListener('click', function() {
            const svgContent = document.getElementById('visualizationDisplay').innerHTML;
            const blob = new Blob([svgContent], {type: 'image/svg+xml'});
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'pattern_visualization.svg';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
        
        // Color picker functionality
        document.querySelectorAll('.color-box').forEach(box => {
            box.addEventListener('click', function() {
                const id = this.id;
                const currentColor = this.getAttribute('data-color');
                
                // Simple color rotation for demo
                const colors = ['#EC4899', '#8B5CF6', '#F472B6', '#FB7185', '#14B8A6', '#F59E0B'];
                const currentIndex = colors.indexOf(currentColor);
                const nextIndex = (currentIndex + 1) % colors.length;
                
                this.style.backgroundColor = colors[nextIndex];
                this.setAttribute('data-color', colors[nextIndex]);
            });
        });
    </script>
</body>
</html>