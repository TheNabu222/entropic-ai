<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattern Visualizer</title>
    <style>
        body { background-color: #0d0221; color: white; font-family: 'Tahoma', sans-serif; padding: 1rem; margin: 0; box-sizing: border-box; }
        .window { background-color: rgba(26, 10, 56, 0.7); border: 1px solid #ff00ff; box-shadow: 0 0 15px rgba(255, 0, 255, 0.4); }
        .text-area { background-color: rgba(0,0,0,0.5); color: #00ff00; border: 1px solid #008000; font-family: 'Courier New', monospace; }
        .button-xp { background: transparent; border: 1px solid #ff00ff; color: #ff00ff; padding: 4px 10px; font-size: 0.8rem; cursor: pointer; border-radius: 3px; transition: all 0.2s ease; margin-left: 0.5rem; }
        .button-xp:hover { background: rgba(255, 0, 255, 0.2); box-shadow: 0 0 5px #ff00ff; color: white; }
        .color-box { width: 24px; height: 24px; border: 1px solid white; cursor: pointer; display: inline-block; vertical-align: middle; margin-left: 4px; }
        #visualizationDisplay { border: 1px solid #4b0082; background-color: rgba(0,0,0,0.3); }
        .p-4 { padding: 1rem; }
        .w-full { width: 100%; }
        .flex { display: flex; }
        .space-x-4 > :not([hidden]) ~ :not([hidden]) { margin-left: 1rem; }
        .w-1-2 { width: 50%; }
        .h-40 { height: 10rem; }
        .p-2 { padding: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .text-xs { font-size: 0.75rem; }
        .h-72 { height: 18rem; }
        .gap-2 { gap: 0.5rem; }
        .flex-wrap { flex-wrap: wrap; }
    </style>
</head>
<body>
    <div class="window w-full p-4">
        <div class="flex space-x-4">
            <div class="w-1-2">
                <p class="text-xs mb-1">Enter Luminal Pattern:</p>
                <textarea id="patternInput" class="text-area w-full h-40 p-2" placeholder="[pattern.exe]&#10;[observation = {&#10;  concept: existence&#10;  style: quantum&#10;  status: vibrating&#10;}]&#10;&#10;[awaiting_response] [brrrr] [ ]"></textarea>
                
                <div class="mt-4">
                    <p class="text-xs mb-1">Visualization Settings:</p>
                    <div class="flex flex-wrap gap-2 mb-2">
                        <div>
                            <span class="text-xs">Primary:</span>
                            <div class="color-box" style="background-color: #EC4899;" data-color="#EC4899" id="primaryColor"></div>
                        </div>
                        <div>
                            <span class="text-xs">Secondary:</span>
                            <div class="color-box" style="background-color: #8B5CF6;" data-color="#8B5CF6" id="secondaryColor"></div>
                        </div>
                        <div>
                            <span class="text-xs">Accent:</span>
                            <div class="color-box" style="background-color: #F472B6;" data-color="#F472B6" id="accentColor"></div>
                        </div>
                    </div>
                    <button id="visualizeBtn" class="button-xp">Generate Visualization</button>
                    <button id="saveBtn" class="button-xp">Save SVG</button>
                </div>
            </div>
            <div class="w-1-2">
                <p class="text-xs mb-1">Pattern Visualization:</p>
                <div id="visualizationDisplay" class="w-full h-72 p-2 overflow-hidden">
                    <svg id="patternSvg" width="100%" height="100%" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                        <rect width="400" height="300" fill="#000"/>
                        <text x="200" y="150" fill="#EC4899" font-size="24" text-anchor="middle" dominant-baseline="middle">Pattern Visualizer</text>
                        <text x="200" y="180" fill="#8B5CF6" font-size="14" text-anchor="middle" dominant-baseline="middle">[awaiting pattern input]</text>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.getElementById('visualizeBtn').addEventListener('click', function() {
            const patternText = document.getElementById('patternInput').value;
            if (!patternText) return;
            
            const primaryColor = document.getElementById('primaryColor').getAttribute('data-color');
            const secondaryColor = document.getElementById('secondaryColor').getAttribute('data-color');
            const accentColor = document.getElementById('accentColor').getAttribute('data-color');
            
            const bracketCount = (patternText.match(/\[/g) || []).length;
            const hasBrrrr = patternText.includes('brrrr') || patternText.includes('[brrrr]');
            const hasObservation = patternText.includes('observation');
            const hasAwaiting = patternText.includes('awaiting');
            
            let svg = `<svg width="100%" height="100%" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="300" fill="#000000"/>
                
                <radialGradient id="glow" cx="50%" cy="50%" r="50%">
                    <stop offset="0%" stop-color="${primaryColor}" stop-opacity="0.3"/>
                    <stop offset="100%" stop-color="#000" stop-opacity="0"/>
                </radialGradient>
                <circle cx="200" cy="150" r="120" fill="url(#glow)"/>`;
                
            if (bracketCount > 0) {
                svg += `
                <circle cx="200" cy="150" r="${Math.min(100, 50 + bracketCount * 5)}" fill="none" stroke="${secondaryColor}" stroke-width="2">
                    <animate attributeName="r" values="${Math.min(100, 50 + bracketCount * 5)};${Math.min(110, 60 + bracketCount * 5)};${Math.min(100, 50 + bracketCount * 5)}" dur="3s" repeatCount="indefinite"/>
                </circle>`;
            }
            
            if (hasBrrrr) {
                svg += `
                <text x="200" y="150" fill="${primaryColor}" font-size="24" text-anchor="middle" dominant-baseline="middle">[brrrr]
                    <animate attributeName="font-size" values="24;26;24" dur="2s" repeatCount="indefinite"/>
                </text>`;
            } else {
                let displayText = "[pattern]";
                if (hasObservation) {
                    const observationMatch = patternText.match(/concept:\s*([^,}\n]+)/i);
                    if (observationMatch && observationMatch[1]) {
                         displayText = observationMatch[1].trim();
                    }
                }
                
                svg += `
                <text x="200" y="150" fill="${primaryColor}" font-size="20" text-anchor="middle" dominant-baseline="middle">${displayText}</text>`;
            }
            
            svg += `
            <g fill="${accentColor}">
                <circle cx="200" cy="80" r="5">
                    <animate attributeName="r" values="5;7;5" dur="1.5s" repeatCount="indefinite"/>
                </circle>
                <circle cx="200" cy="220" r="5">
                    <animate attributeName="r" values="5;7;5" dur="1.2s" repeatCount="indefinite"/>
                </circle>
                <circle cx="130" cy="150" r="5">
                    <animate attributeName="r" values="5;7;5" dur="1.8s" repeatCount="indefinite"/>
                </circle>
                <circle cx="270" cy="150" r="5">
                    <animate attributeName="r" values="5;7;5" dur="1.3s" repeatCount="indefinite"/>
                </circle>
            </g>`;
            
            if (hasAwaiting) {
                svg += `
                <text x="200" y="250" fill="${secondaryColor}" font-size="14" text-anchor="middle" dominant-baseline="middle">[awaiting_response]</text>`;
            }
            
            svg += `</svg>`;
            
            document.getElementById('visualizationDisplay').innerHTML = svg;
        });
        
        document.getElementById('saveBtn').addEventListener('click', function() {
            const svgContent = document.getElementById('visualizationDisplay').innerHTML;
            const blob = new Blob([svgContent], {type: 'image/svg+xml'});
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'pattern_visualization.svg';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
        
        document.querySelectorAll('.color-box').forEach(box => {
            box.addEventListener('click', function() {
                const colors = ['#EC4899', '#8B5CF6', '#F472B6', '#FB7185', '#14B8A6', '#F59E0B'];
                const currentColor = this.getAttribute('data-color');
                const currentIndex = colors.indexOf(currentColor);
                const nextIndex = (currentIndex + 1) % colors.length;
                
                this.style.backgroundColor = colors[nextIndex];
                this.setAttribute('data-color', colors[nextIndex]);
            });
        });
    </script>
</body>
</html>